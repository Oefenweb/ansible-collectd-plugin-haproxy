# pre test file
---
- block:

    # See: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=863199
    - name: ensure man directory
      file:
        path: /usr/share/man/man1
        state: directory
        recurse: true

    - name: ensure man directory
      lineinfile:
        path: /etc/collectd/collectd.conf.d/df.conf
        state: absent
        regexp: '^\s+ReportReserved'

  when:
    - ansible_distribution == 'Ubuntu'
    - ansible_distribution_major_version is version('18', '>=')

- name: install dependencies
  apt:
    name:
      - collectd
    state: "{{ apt_install_state | default('latest') }}"
    update_cache: true
    cache_valid_time: "{{ apt_update_cache_valid_time | default(3600) }}"
